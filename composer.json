{
    "name": "linuxmalaysia/cmsfornerd",
    "description": "A flat-file CMS modernized for PHP 8.4",
    "type": "project",
    "license": "GPL-3.0-or-later",
    "authors": [
        {
            "name": "Harisfazillah Jamel",
            "email": "linuxmalaysia@songketmail.org",
            "homepage": "https://www.linuxmalaysia.com/"
        }
    ],
    "require": {
        "php": ">=8.4"
    },
    "require-dev": {
        "phpunit/phpunit": "^11.5",
        "squizlabs/php_codesniffer": "^3.11"
    },
    "scripts": {
        "check-style": "phpcs --standard=PSR12 includes/",
        "fix-style": "phpcbf --standard=PSR12 includes/",
        "test": "phpunit",
        "check-strict": [
            "php -r \"$files = new RecursiveIteratorIterator(new RecursiveDirectoryIterator('includes')); $found = false; foreach ($files as $file) { if ($file->isDir()) continue; $content = file_get_contents($file->getPathname()); if (str_contains($content, 'global $')) { echo '[FAIL] Global keyword found in ' . $file->getPathname() . PHP_EOL; $found = true; } } if (!$found) echo '[OK] No global keyword found.' . PHP_EOL;\"",
            "php -r \"$files = new RecursiveIteratorIterator(new RecursiveDirectoryIterator('includes')); foreach ($files as $file) { if ($file->isDir()) continue; $content = file_get_contents($file->getPathname()); if (!preg_match('/declare\\s*\\(\\s*strict_types\\s*=\\s*1\\s*\\)\\s*;/', $content)) echo '[WARN] Missing strict_types in ' . $file->getPathname() . PHP_EOL; }\""
        ],
        "compliance": [
            "@check-style",
            "@check-strict",
            "@test"
        ],
        "audit-metadata": "php tools/audit-semantics.php http://localhost:8888",
        "lab-check": [
            "php -r \"echo 'Checking Laboratory Environment...\\n';\"",
            "php -r \"$f='docs/LAB-GUIDE.md'; echo (file_exists($f) ? '[OK] Lab Guide found.\\n' : '[FAIL] Missing docs/LAB-GUIDE.md\\n');\"",
            "php -r \"$f='includes/bootstrap.php'; echo (file_exists($f) ? '[OK] Bootstrap found.\\n' : '[FAIL] Missing includes/bootstrap.php\\n');\"",
            "php -r \"echo 'Running Laboratory Strictness Check...\\n';\"",
            "@check-strict",
            "php -r \"echo 'Running PSR-12 Compliance Check...\\n';\"",
            "@check-style"
        ],
        "post-install-cmd": [
            "php -r \"echo 'Welcome to the CmsForNerd Laboratory.\\nRun [composer lab-check] to verify your setup.\\n';\""
        ]
    },
    "autoload": {
        "psr-4": {
            "CmsForNerd\\": "includes/"
        }
    },
    "config": {
        "allow-plugins": {
            "php-http/discovery": true
        },
        "sort-packages": true,
        "optimize-autoloader": true
    }
}
